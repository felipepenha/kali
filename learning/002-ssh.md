# Secure Shell (SSH)

Since you are pushing code via CI/CD, the secure transfer of your identity relies heavily on cryptographic key pairs, specifically using **Secure Shell (SSH)** for authentication over SFTP. SSH/SFTP runs on TCP port 22.

Secure Shell (SSH) is the principal means of obtaining secure remote access to
UNIX and Linux servers and to most types of network appliances (switches, routers,
and firewalls). As well as terminal emulation, SSH can be used as the secure file
transfer protocol (SFTP). There are numerous commercial and open source SSH
servers and terminal emulation clients available for all the major NOS platforms
(UNIX速, Linux速, Windows速, and macOS速). The most widely used is [OpenSSH](https://www.openssh.com).
An SSH server listens on TCP port 22 by default.

Let's move this core security concept into a practical step by generating the key pair used to achieve non-repudiation and authentication in a secure development workflow.

### Terminal Practice: Generating an SSH Key Pair

A key pair consists of a **public key** (which you share) and a **private key** (which must be kept secret). We will use the `ssh-keygen` utility in your Kali container.

Run the following command to generate a strong 4096-bit RSA key pair:

```bash
ssh-keygen -t rsa -b 4096
```

1.  Press **Enter** to accept the default file location (`/root/.ssh/id_rsa`).
2.  Enter a passphrase when prompted (this protects the private key if your laptop is compromised).

After the command runs, you will see two files created (likely in the hidden `.ssh` directory in your home folder).

**What are the names of the two files that were generated?** (Hint: One is the private key, and one is the public key.)

<mark>Answer</mark>

```bash
# ssh-keygen: A tool for creating and managing authentication keys.
# -t rsa: Specifies the type of key to create, in this case, RSA.
# -b 4096: Specifies the number of bits in the key (4096 for a strong key).
# -f id_rsa: Specifies the filename for the new key.
# -N "passphrase": Provides the passphrase for the key.
ssh-keygen -t rsa -b 4096 -f id_rsa -N "passphrase"

cat id_rsa

echo ""
echo "-----BEGIN OPENSSH PUBLIC KEY-----"

cat id_rsa.pub

echo "-----END OPENSSH PUBLIC KEY-----"

rm id_rsa

rm id_rsa.pub
```

```bash
bash learning/0002-ssh.sh
Generating public/private rsa key pair.
Your identification has been saved in id_rsa
Your public key has been saved in id_rsa.pub
The key fingerprint is:
SHA256:A6TMEStQkEmU/h8R3tIxOszI4/zhUyqc2d+YUZRqkDw root@bb1f598ee6e7
The key's randomart image is:
+---[RSA 4096]----+
|=Bo o..          |
|oo o.*.o  .      |
|. o XE* oo       |
| . = Oo+o        |
|  + . +oS.       |
|   + o....       |
|  . B =.         |
|   = B  =        |
|    . o+ .       |
+----[SHA256]-----+
-----BEGIN OPENSSH PRIVATE KEY-----
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
WEke5u3qW1m1z10W8myE1kcsI=
-----END OPENSSH PRIVATE KEY-----

-----BEGIN OPENSSH PUBLIC KEY-----
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQChvXwkBSuYzATUIYAW2QS46sY7JfbaE9tvRpUnDaZN6CMl5PA3PlzuIxKT3n5g2kHCPoYSVSyHRlyFwj5kTil/XLu8ZzqxnexCqZCOLmlErpzF3YZ9QSPo2LTK84og3nbiHFUw8P0RgzWdWyIYUbNj8Acgm/56R3ktNYL5Rie2E2xt8N+N4B1lTORikmTI0sdmfnk78JP2qm9yPftgkYu6OVO2lHo9WWeN5NN+CZu3Wr/v+A6ACKxdoMBdTPU8EWWheaiwU0qeSW7iFc2iwBDZIEKeXDfMsWS5qZ1prGKJ1CbIF4xFpbRCmIwjqfrW/O7hwFgG0lJTO64uahMsCA1KX9Q4sIpZ4W9HEQ32GdYoYWFhdyD0JOcPxcMhCOpddC4qxVPghqoyweQAkKbf1NDDjwqKEBOIu0MIfEowCe2cp8IEsNh3UC6xZAg/+Li2105A6+zoyR4ZXd758+5HUT1eZZKhcyhCSI8SwiK1Xm9YDgTh9PmnVhC5E821t9f25sZZ+mJvjI3q8XaHbeZGqxTbDvyxze/6DrY178iIVWkf3O42VmNWKXuRC6cdp9Eka1JCiRgFD7qqh5YJVt1XTM2MtPFFt5qtFl/M8dU/smRgxoJFa6M+Kfk0U2U5TUrrQ8a57hnM6AZxCLeIJRi+hSn0x9SEtdBQKBceUBAVzvcbRw== root@bb1f598ee6e7
-----END OPENSSH PUBLIC KEY-----
```

That terminal exercise beautifully demonstrates the cryptographic process used for secure access!

You successfully generated a public/private **asymmetric key pair** using `ssh-keygen`. This system provides strong **authentication** and is critical for secure data transfer using protocols like **SFTP**.

The two files created are:
1.  **`id_rsa`**: Your **private key**.
2.  **`id_rsa.pub`**: Your **public key**.

This asymmetric pair works because anything encrypted by one key can only be decrypted by the other.

To enable passwordless, secure authentication (providing authentication and non-repudiation) when you interact with a remote repository (like GitHub) or a deployment server:

**Which of these two files (`id_rsa` or `id_rsa.pub`) must be copied to the remote server?** Why must the other file remain secret on your laptop?

<mark>Answer: The publich key is copied, since the private key is secret.</mark>

That is spot on!

You correctly identified that the **public key** (`id_rsa.pub`) is copied to the remote server. The **private key** (`id_rsa`) must always remain private and secret.

The system relies on this secrecy to guarantee:

1.  **Authentication:** The server uses your public key to verify that the person requesting access possesses the matching private key, confirming your identity.
2.  **Non-repudiation:** If you use your private key to digitally sign (encrypt a hash of) code, you cannot later deny that you sent it, as only your private key could have created the signature.

If your private key were compromised, an attacker could masquerade as you.

# TCP

**TCP** stands for **Transmission Control Protocol**. It is one of the fundamental protocols of the internet, operating at the **Transport Layer** (Layer 4) of the TCP/IP model.

Its main function is to provide **reliable, ordered, and error-checked delivery of a stream of data** between applications running on different hosts in a network.

***

## How TCP Works: Key Features

TCP is often called a "reliable" or "connection-oriented" protocol because it includes mechanisms to ensure that data is delivered completely and correctly, contrasting with protocols like UDP (User Datagram Protocol), which are faster but less reliable.

### 1. Connection-Oriented (The Three-Way Handshake)
Before any data is exchanged, TCP establishes a virtual connection between the sender and the receiver. This process is called the **Three-Way Handshake** and involves three steps:

1.  **SYN** (Synchronize): The client sends a packet to the server to request a connection.
2.  **SYN-ACK** (Synchronize-Acknowledge): The server acknowledges the request and sends its own synchronization request.
3.  **ACK** (Acknowledge): The client acknowledges the server's response, and the connection is officially established.

### 2. Reliability (Acknowledgment and Retransmission)
TCP guarantees that all data arrives at the destination.
* The data is broken down into numbered **segments** (packets).
* The receiver sends an **acknowledgment (ACK)** back to the sender for each segment received.
* If the sender does not receive an ACK within a certain timeout period, it assumes the segment was lost and automatically **retransmits** it.

### 3. Ordered Data Delivery (Sequencing)
Since packets can travel different routes across the internet and arrive out of order, TCP uses **sequence numbers** to reassemble the data segments correctly at the receiving end, ensuring the application receives the data exactly as it was sent.

### 4. Flow Control
TCP uses a mechanism called a **sliding window** to prevent a fast sender from overwhelming a slow receiver. The receiver tells the sender how much data it can handle at one time, controlling the transmission rate to avoid data loss.

### 5. Congestion Control
TCP also monitors the overall network condition and slows down the transmission rate if it detects network congestion, helping to maintain network stability.

***

## Applications that Use TCP

TCP is used by virtually all applications where data integrity is critical, including:

* **HTTP/HTTPS** (Web Browsing)
* **FTP** (File Transfer Protocol)
* **SSH** (Secure Shell)
* **SMTP/POP3/IMAP** (Email)
* **Telnet** (Older remote terminal access)